---
title: "detection_profile"
author: "Kristen Dang"
date: "January 20, 2015"
output: 
  html_document: 
    fig_height: 7
---
```{r}
library('rGithubClient')
source('/Users/kristen/Computing/external_software/rgithubclient_authenticate.R')
library(edgeR)
library(gplots)
sourceRepoFile(sageCode, "rnaseq_analysis_functions.R")
sourceRepoFile(sageCode, "detection_profiling_functions.R")
```

# Get data
```{r}
sourceRepoFile(sageCode, "NIA-AMP-AD/sample_swap_preliminary.R")
```


# Detection analysis of biotypes
```{r}
countsData = list(Mayo=mayoR.dge, MSSM=mssmR.dge,Broad=broadR.dge)
for (i in 1:3){
  data.dge = countsData[[i]]
  paloResult = simplifyBiotypeCategories(data.dge,biomart=Hs)
  paloCounts_wdetect = plotNumSamplesDetecting(paloResult$data)
  paloRegressResults = runRegressionAndPlot(inCounts = paloCounts_wdetect,bioCategoryCounts = paloResult$observedCounts,totalBiotypeCounts = paloResult$totalCounts,inLibSize = data.dge$samples$lib.size)
  quadrantPlot(paloRegressResults,observedBioCounts = paloResult$observedCounts,plotTitle = names(countsData[i]))
}


```



